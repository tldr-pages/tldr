# tcpdump

> Создавать дамп сетевого трафика.
> Больше информации: <https://www.tcpdump.org/manpages/tcpdump.1.html>.

- Вывести список доступных сетевых интерфейсов:

`tcpdump {{[-D|--list-interfaces]}}`

- Захватить трафик с определённого интерфейса:

`sudo tcpdump {{[-i|--interface]}} {{eth0}}`

- Захватить весь TCP-трафик, показывая содержимое в консоли в формате [A]SCII:

`sudo tcpdump -A tcp`

- Захватить трафик, идущий от хоста или к хосту:

`sudo tcpdump host {{www.example.com}}`

- Захватить трафик с определённого интерфейса, источника, назначения и порта назначения:

`sudo tcpdump {{[-i|--interface]}} {{eth0}} src {{192.168.1.1}} and dst {{192.168.1.2}} and dst port {{80}}`

- Захватить трафик сети:

`sudo tcpdump net {{192.168.1.0/24}}`

- Захватить весь трафик, кроме трафика на порту 22, и записать ([w]rite) его в файл дампа:

`sudo tcpdump -w {{путь/к/файлу_дампа.pcap}} port not 22`

- Прочитать ([r]ead) из указанного файла дампа:

`tcpdump -r {{путь/к/файлу_дампа.pcap}}`
